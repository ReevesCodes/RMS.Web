@* @{
    ViewData["Title"] = "Forgot Password";
}

<h3>Forgot Password</h3>

<form asp-action="ForgotPassword" method="post">
    <div class="mb-3">
        <label for="email" class="form-label">Enter your email address</label>
        <input type="email" name="email" class="form-control" required />
    </div>
    <button type="submit" class="btn btn-warning">Send Reset Link</button>
</form>

@if (ViewBag.Error != null)
{
    <div class="alert alert-danger mt-2">@ViewBag.Error</div>
}
@if (ViewBag.Message != null)
{
    <div class="alert alert-success mt-2">@ViewBag.Message</div>
} *@


@* 
@{
    ViewData["Title"] = "Forgot Password";
}

<h1 tabindex="0" role="heading" aria-level="1">Forgot Password</h1>

<p id="instructions" tabindex="0" aria-live="polite" role="region">
    Please enter your email address below. After submitting, you will receive a password reset link via email.
</p>

<form asp-action="ForgotPassword" method="post" aria-describedby="instructions" role="form">
    <div class="mb-3">
        <label for="email" class="form-label" aria-label="Email address input label">Email address</label>
        <input type="email" id="email" name="email" class="form-control" required aria-required="true" aria-describedby="emailHelp" />
        <div id="emailHelp" class="form-text" role="note">
            Enter the email you used to register your account.
        </div>
    </div>

    <button type="submit" class="btn btn-warning" aria-label="Send password reset link button">
        Send Reset Link
    </button>
</form>

@if (ViewBag.Error != null)
{
    <div class="alert alert-danger mt-2" role="alert" aria-live="assertive">@ViewBag.Error</div>
}
@if (ViewBag.Message != null)
{
    <div class="alert alert-success mt-2" role="alert" aria-live="polite">@ViewBag.Message</div>
}

@section Scripts {
<script>
    // Voice guidance: read instructions aloud when page loads
    window.addEventListener('DOMContentLoaded', () => {
        const instructions = document.getElementById('instructions').textContent;
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(instructions);
            window.speechSynthesis.speak(utterance);
        }
    });
</script>
} *@


@{
    ViewData["Title"] = "Forgot Password";
}

<div class="d-flex justify-content-center align-items-center vh-100 bg-light">
    <div class="card shadow-sm border-0 rounded-4" style="width: 400px;">
        <div class="card-body p-4">
            <h4 class="text-center mb-3" id="forgotHeading" tabindex="-1">Forgot Password</h4>

            <p id="instructions" class="small text-muted text-center mb-3" tabindex="0" aria-live="polite">
                Please enter your email address below. After submitting, you will receive a password reset link via email.
            </p>

            <form asp-action="ForgotPassword" method="post" aria-describedby="instructions" role="form">
                
                <!-- EMAIL -->
                <div class="mb-3">
                    <label for="email" class="form-label small fw-bold">Email address</label>
                    <div class="input-group input-group-sm">
                        <input type="email" id="email" name="email" class="form-control form-control-sm" 
                               required aria-required="true" aria-describedby="emailHelp" />
                        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="startVoiceInput('email')">ðŸŽ¤</button>
                    </div>
                    <div id="emailHelp" class="form-text small" role="note">
                        Enter the email you used to register your account.
                    </div>
                </div>

                <!-- SUBMIT -->
                <div class="d-grid mb-2">
                    <button type="submit" class="btn btn-warning btn-sm" aria-label="Send password reset link button">
                        Send Reset Link
                    </button>
                </div>
            </form>

            <!-- ALERTS -->
            @if (ViewBag.Error != null)
            {
                <div class="alert alert-danger mt-2 small text-center" role="alert" aria-live="assertive">@ViewBag.Error</div>
            }
            @if (ViewBag.Message != null)
            {
                <div class="alert alert-success mt-2 small text-center" role="alert" aria-live="polite">@ViewBag.Message</div>
            }
        </div>
    </div>
</div>

@section Scripts {
<script>
    // Speak page instructions on load
    window.addEventListener('DOMContentLoaded', () => {
        const instructions = document.getElementById('instructions').textContent;
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(instructions);
            window.speechSynthesis.speak(utterance);
        }
        document.getElementById('forgotHeading').focus();
    });

    // Voice input
    function startVoiceInput(fieldId) {
        if (!('webkitSpeechRecognition' in window)) {
            alert("Voice recognition not supported.");
            return;
        }

        const recognition = new webkitSpeechRecognition();
        recognition.lang = 'en-US';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.start();

        recognition.onresult = function (event) {
            const transcript = event.results[0][0].transcript.trim();
            document.getElementById(fieldId).value = transcript;
            speak(`${fieldId} set to ${transcript}`);
        };

        recognition.onerror = function (event) {
            alert('Speech recognition error: ' + event.error);
        };
    }

    // Speech feedback
    function speak(message) {
        const synth = window.speechSynthesis;
        const utterance = new SpeechSynthesisUtterance(message);
        synth.speak(utterance);
    }
</script>
}
